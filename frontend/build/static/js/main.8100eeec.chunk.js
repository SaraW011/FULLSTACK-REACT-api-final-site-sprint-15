(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{11:function(e,t,n){e.exports=n.p+"static/media/logo.8f7611ae.svg"},12:function(e,t,n){e.exports=n.p+"static/media/vSign.e38b395c.svg"},13:function(e,t,n){e.exports=n.p+"static/media/xSign.4072126c.svg"},15:function(e,t,n){e.exports=n(86)},24:function(e,t,n){},86:function(e,t,n){"use strict";n.r(t);var a=n(1),r=n.n(a),o=n(10),c=n.n(o),i=n(5),l=(n(24),n(14)),s=n(3),u=n.n(s),m=n(6),p=n(2),d=n(0),f=n(11),h=n.n(f);var _=function(e){e.props,e.isOpen;var t=e.loggedIn,n=e.handleLogout,a=e.email,o=(e.mobileMenu,e.showMobileIcon,Object(d.f)().pathname);return r.a.createElement("header",{className:"header"},r.a.createElement(i.b,{className:"logo",to:"/"},r.a.createElement("img",{id:"site-logo",src:h.a,alt:"Around the USA logo"})),t?r.a.createElement("div",{className:"header__menu",email:a},r.a.createElement("h2",{className:"header__user-email"},a),r.a.createElement(i.b,{className:"header__page-link",to:"/signin",onClick:n},"Log out")):r.a.createElement(r.a.Fragment,null,"/signin"===o?r.a.createElement(i.b,{to:"/signup",className:"header__page-link"},"Sign up"):r.a.createElement(i.b,{to:"/signin",className:"header__page-link"},"Log in")))},g=r.a.createContext();function b(e){var t=e.onCardClick,n=e.card,a=e.onCardLike,o=e.onCardDelete;var c=r.a.useContext(g),i=n.owner===c._id?"elements__trash":"elements__trash_disabled",l=n.likes.some(function(e){return e===c._id})?"elements__heart_active":"elements__heart";return r.a.createElement("li",{className:"elements__element"},r.a.createElement("button",{className:i,type:"button","aria-label":"delete card",onClick:function(){o(n)}}),r.a.createElement("img",{className:"elements__image",src:n.link,alt:n.name,onClick:function(){t(n)}}),r.a.createElement("div",{className:"elements__info"},r.a.createElement("h2",{className:"elements__text"},n.name),r.a.createElement("div",{className:"elements__like-container"},r.a.createElement("button",{className:l,type:"button","aria-label":"like card",onClick:function(){a(n)}}),r.a.createElement("div",{className:"elements__number-of-likes"},n.likes.length))))}function E(e){var t=e.onEditAvatarClick,n=e.onEditProfileClick,a=e.onAddPlaceClick,o=e.onCardClick,c=e.onCardLike,i=e.onCardDelete,l=e.cards,s=r.a.useContext(g);return r.a.createElement("main",null,r.a.createElement("section",{className:"profile"},r.a.createElement("div",{className:"profile__avatar-wrapper"},r.a.createElement("img",{className:"profile__avatar",src:s.avatar,alt:"My Avatar"}),r.a.createElement("button",{onClick:t,type:"button","aria-label":"edit-avatar-button",className:"profile__avatar-edit-button"})),r.a.createElement("div",{className:"profile__info"},r.a.createElement("div",null,r.a.createElement("h1",{className:"profile__name"},s.name),r.a.createElement("button",{onClick:n,"aria-label":"edit-button",type:"button",className:"profile__edit-button",name:"edit"})),r.a.createElement("h2",{className:"profile__title"},s.about)),r.a.createElement("button",{onClick:a,type:"button","aria-label":"add-button",className:"profile__add-button"})),r.a.createElement("section",{className:"elements"},r.a.createElement("ul",{className:"elements__list"},l.map(function(e){return r.a.createElement(b,{card:e,key:e._id,onCardClick:o,onCardLike:c,onCardDelete:i})}))))}var v=function(){return r.a.createElement("footer",{className:"footer"},r.a.createElement("p",{className:"footer__copyright"},"\xa9 ",(new Date).getFullYear()," Sara Weissman"))};function k(e){var t=e.name,n=e.isOpen,a=e.onClose,o=e.children;return r.a.useEffect(function(){if(n){var e=function(e){"Escape"===e.key&&a()};return document.addEventListener("keydown",e),function(){return document.removeEventListener("keydown",e)}}},[n,a]),r.a.createElement("div",{className:"modal ".concat(n?"modal_open":""," modal_type_").concat(t)},o)}function y(e){return r.a.createElement(k,{onClose:e.onClose,isOpen:e.isOpen,name:e.name},r.a.createElement("div",{className:"modal__image-wrapper"},r.a.createElement("button",{type:"button","aria-label":"close-button",className:"modal__close-button modal__close-button_type-preview",onClick:e.onClose}),r.a.createElement("figure",null,r.a.createElement("img",{src:e.imageLink,alt:e.imageText,className:"modal__image-container"}),r.a.createElement("figcaption",{className:"modal__image-caption"},e.imageText))))}function C(e){return r.a.createElement(k,{onClose:e.onClose,isOpen:e.isOpen,name:e.name},r.a.createElement("div",{className:"modal__container"},r.a.createElement("button",{type:"button","aria-label":"close-button",className:"modal__close-button",onClick:e.onClose}),r.a.createElement("h3",{className:"modal__title"},e.title),r.a.createElement("form",{action:"#",className:"form form-".concat(e.name),name:"form-".concat(e.name),onSubmit:e.onSubmit},e.children,r.a.createElement("button",{type:"submit",className:"form__button form__button_type-".concat(e.name),"aria-label":"delete-button"}," ",e.buttonText))))}function N(e){var t=r.a.useContext(g),n=r.a.useState(""),a=Object(p.a)(n,2),o=a[0],c=a[1],i=r.a.useState(""),l=Object(p.a)(i,2),s=l[0],u=l[1];return r.a.useEffect(function(){c(t.name||""),u(t.about||"")},[t,e.isOpen]),r.a.createElement(C,{name:"edit-profile",onClose:e.onClose,isOpen:e.isOpen,onSubmit:function(t){t.preventDefault(),e.onUpdateUser({name:o,about:s})},title:"Edit profile",buttonText:"Save"},r.a.createElement("input",{id:"input_type_name",type:"text",value:o,onChange:function(e){c(e.target.value)},className:"form__input form__input_type_name",placeholder:"name",name:"name",minLength:"2",maxLength:"40",required:!0}),r.a.createElement("span",{id:"input_type_name-error",className:"form__error"}),r.a.createElement("input",{id:"input_type_job",type:"text",value:s,onChange:function(e){u(e.target.value)},className:"form__input form__input_type_job",placeholder:"profession",name:"job",minLength:"2",maxLength:"200",required:!0}),r.a.createElement("span",{id:"input_type_job-error",className:"form__error"}))}function O(e){var t=r.a.useRef();return r.a.useEffect(function(){t.current.value=""},[]),r.a.createElement(C,{name:"edit-avatar",onClose:e.onClose,isOpen:e.isOpen,onSubmit:function(n){n.preventDefault(),console.log(t.current.value,"frontend"),e.onUpdateAvatar({avatar:t.current.value})},title:"Change profile picture",buttonText:"Save"},r.a.createElement("input",{ref:t,id:"input_type_avatar-url",type:"url",className:"form__input form__input_type_link",placeholder:"avatar link",name:"link",required:!0}),r.a.createElement("span",{id:"input_type_avatar-url-error",className:"form__error_visible"}))}function S(e){var t=r.a.useState(""),n=Object(p.a)(t,2),a=n[0],o=n[1],c=r.a.useState(""),i=Object(p.a)(c,2),l=i[0],s=i[1];return r.a.useEffect(function(){o(""),s("")},[e.isOpen]),r.a.createElement(C,{name:"add-place",onClose:e.onClose,isOpen:e.isOpen,onSubmit:function(t){t.preventDefault(),e.onAddPlaceSubmit({name:a,link:l})},title:"New place",buttonText:"Create"},r.a.createElement("input",{onChange:function(e){o(e.target.value)},value:a||"",id:"input_type_place",type:"text",className:"form__input form__input_type_place",placeholder:"Title",name:"place",minLength:"2",maxLength:"30",required:!0}),r.a.createElement("span",{id:"input_type_place-error",className:"form__error"}),r.a.createElement("input",{onChange:function(e){s(e.target.value)},value:l||"",id:"input_type_url",type:"url",className:"form__input form__input_type_link",placeholder:"Image link",name:"link",required:!0}),r.a.createElement("span",{id:"input_type_url-error",className:"form__error"}))}function w(e){return r.a.createElement(C,{name:"confirm-delete",title:"Are you Sure?",buttonText:"Yes",isOpen:e.isOpen,onSubmit:e.onSubmit,onClose:e.onClose})}function j(e){var t=r.a.useState(""),n=Object(p.a)(t,2),a=n[0],o=n[1],c=r.a.useState(""),l=Object(p.a)(c,2),s=l[0],u=l[1];return r.a.createElement("div",{className:"login"},r.a.createElement("p",{className:"login__title"},"Welcome back!"),r.a.createElement("form",{onSubmit:function(t){t.preventDefault(),a&&s?e.onSubmit(a,s):console.log("could not log in")},className:"login__form"},r.a.createElement("input",{className:"login__input",id:"email",name:"email",placeholder:"Email",type:"text",value:a,onChange:function(e){o(e.target.value)}}),r.a.createElement("input",{className:"login__input",id:"password",name:"password",type:"password",placeholder:"Password",value:s,onChange:function(e){u(e.target.value)}}),r.a.createElement("button",{type:"submit",className:"login__button"},"Log in")),r.a.createElement(i.b,{to:"/signup",className:"login__link"},"Not a member yet? Sign up here!"))}function x(e){var t=r.a.useState(""),n=Object(p.a)(t,2),a=n[0],o=n[1],c=r.a.useState(""),l=Object(p.a)(c,2),s=l[0],u=l[1];return r.a.createElement("div",{className:"login"},r.a.createElement("h1",{className:"login__title"},"Sign Up"),r.a.createElement("form",{className:"login__form",onSubmit:function(t){t.preventDefault(),a&&s?e.onSubmit(a,s):console.log("could not register")}},r.a.createElement("input",{className:"login__input",name:"email",placeholder:"Email",type:"email",value:a,onChange:function(e){o(e.target.value)}}),r.a.createElement("input",{className:"login__input",name:"password",placeholder:"Password",type:"password",value:s,onChange:function(e){u(e.target.value)}}),r.a.createElement("button",{className:"login__button",type:"submit"},"Sign Up")),r.a.createElement(i.b,{to:"/signin",className:"login__link"},"Already a member? Log in here!"))}var L=function(e){var t=e.loggedIn,n=e.redirectPath,a=void 0===n?"/signup":n,o=e.children;return t?o:r.a.createElement(d.a,{to:a,replace:!0})},T=n(12),A=n.n(T),P=n(13),R=n.n(P);function U(e){return r.a.createElement(k,{onClose:e.onClose,isOpen:e.isOpen,name:e.name},r.a.createElement("div",{className:"modal__container"},r.a.createElement("button",{type:"button","aria-label":"close-button",className:"modal__close-button",onClick:e.onClose}),e.isRegistered?r.a.createElement(r.a.Fragment,null,r.a.createElement("img",{src:A.a,alt:"success"}),r.a.createElement("h2",{className:"modal__title_type_tooltip"},"Success! You have now been registered.",r.a.createElement("br",null),r.a.createElement("br",null),"Please log in with your user credentials.")):r.a.createElement(r.a.Fragment,null,r.a.createElement("img",{src:R.a,alt:"failure"}),r.a.createElement("h2",{className:"modal__title_type_tooltip"},"Oops, something went wrong! Please try again."))))}var I=n(7),D=n(8),B=new(function(){function e(t){Object(I.a)(this,e),this._BASE_URL=t.BASE_URL}return Object(D.a)(e,[{key:"checkResponse",value:function(e){return e.ok?e.json():Promise.reject("Auth Error Type: \n    ".concat(e.status," ").concat(e.statusText))}},{key:"signup",value:function(e,t){return fetch("".concat(this._BASE_URL,"/signup"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:e,password:t})}).then(this.checkResponse)}},{key:"signin",value:function(e,t){return fetch("".concat(this._BASE_URL,"/signin"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:e,password:t})}).then(this.checkResponse).then(function(e){return localStorage.setItem("jwt",e.jwt),e})}},{key:"checkToken",value:function(e){return console.log(e),fetch("".concat(this._BASE_URL,"/users/me"),{method:"GET",headers:{Accept:"application/json","Content-Type":"application/json",authorization:"Bearer ".concat(e)}}).then(this.checkResponse).then(function(e){return e})}}]),e}())({BASE_URL:"https://api.sarawsmn.students.nomoredomainssbs.ru"}),F=new(function(){function e(t){Object(I.a)(this,e),this.checkResponse=function(e){return e.ok?e.json():Promise.reject("Frontend Api Error: \n    ".concat(e.status," ").concat(e.statusText))},this._url=t.baseUrl,this._token=localStorage.getItem("jwt"),this._headers={authorization:"Bearer ".concat(this._token),"Content-type":"application/json"}}return Object(D.a)(e,[{key:"getData",value:function(){var e=Object(m.a)(u.a.mark(function e(){var t;return u.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("".concat(this._url,"/users/me"),{method:"GET",headers:this._headers});case 2:return t=e.sent,e.abrupt("return",this.checkResponse(t));case 4:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"getInitialCards",value:function(){var e=Object(m.a)(u.a.mark(function e(){var t;return u.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("".concat(this._url,"/cards"),{method:"GET",headers:this._headers});case 2:return t=e.sent,e.abrupt("return",this.checkResponse(t));case 4:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"editUserInfo",value:function(){var e=Object(m.a)(u.a.mark(function e(t,n){var a;return u.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return console.log({name:t,about:n}),e.next=3,fetch("".concat(this._url,"/users/me"),{method:"PATCH",headers:this._headers,body:JSON.stringify({name:t,about:n})});case 3:return a=e.sent,e.abrupt("return",this.checkResponse(a));case 5:case"end":return e.stop()}},e,this)}));return function(t,n){return e.apply(this,arguments)}}()},{key:"addPlaceCard",value:function(){var e=Object(m.a)(u.a.mark(function e(t){var n,a,r;return u.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.name,a=t.link,console.log(n,a),e.next=4,fetch("".concat(this._url,"/cards"),{method:"POST",headers:this._headers,body:JSON.stringify({name:n,link:a})});case 4:return r=e.sent,e.abrupt("return",this.checkResponse(r));case 6:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"deleteCard",value:function(){var e=Object(m.a)(u.a.mark(function e(t){var n;return u.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return console.log(t,"== deleted card id"),e.next=3,fetch("".concat(this._url,"/cards/").concat(t),{method:"DELETE",headers:this._headers});case 3:return n=e.sent,e.abrupt("return",this.checkResponse(n));case 5:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"likeCard",value:function(){var e=Object(m.a)(u.a.mark(function e(t){var n;return u.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("".concat(this._url,"/cards/likes/").concat(t),{method:"PUT",headers:this._headers});case 2:return n=e.sent,e.abrupt("return",this.checkResponse(n));case 4:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"dislikeCard",value:function(){var e=Object(m.a)(u.a.mark(function e(t){var n;return u.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("".concat(this._url,"/cards/likes/").concat(t),{method:"DELETE",headers:this._headers});case 2:return n=e.sent,e.abrupt("return",this.checkResponse(n));case 4:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"editAvatar",value:function(){var e=Object(m.a)(u.a.mark(function e(t){var n;return u.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("".concat(this._url,"/users/me/avatar"),{method:"PATCH",headers:this._headers,body:JSON.stringify({avatar:t})});case 2:return n=e.sent,e.abrupt("return",this.checkResponse(n));case 4:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()}]),e}())({baseUrl:"https://api.sarawsmn.students.nomoredomainssbs.ru"});function J(){var e=r.a.useState(!1),t=Object(p.a)(e,2),n=t[0],a=t[1],o=r.a.useState(!1),c=Object(p.a)(o,2),i=c[0],s=c[1],f=r.a.useState(!1),h=Object(p.a)(f,2),b=h[0],k=h[1],C=r.a.useState(!1),T=Object(p.a)(C,2),A=T[0],P=T[1],R=r.a.useState(!1),I=Object(p.a)(R,2),D=I[0],J=I[1],q=r.a.useState({}),M=Object(p.a)(q,2),G=M[0],Y=M[1],z=r.a.useState([]),H=Object(p.a)(z,2),W=H[0],K=H[1],Q=r.a.useState({}),V=Object(p.a)(Q,2),X=V[0],Z=V[1],$=r.a.useState({}),ee=Object(p.a)($,2),te=ee[0],ne=ee[1],ae=r.a.useState(!1),re=Object(p.a)(ae,2),oe=re[0],ce=re[1],ie=r.a.useState(!1),le=Object(p.a)(ie,2),se=le[0],ue=le[1],me=r.a.useState(!1),pe=Object(p.a)(me,2),de=pe[0],fe=pe[1],he=Object(d.g)();function _e(e){K(function(t){return t.map(function(t){return t._id===e._id?e:t})})}function ge(){a(!1),s(!1),k(!1),P(!1),J(!1),ce(!1),Y({})}return r.a.useEffect(function(){var e=localStorage.getItem("jwt");e&&B.checkToken(e).then(function(e){if(e){var t={email:e.email,id:e._id};ne(t),fe(!0)}}).catch(function(e){return console.error(e)})},[]),r.a.useEffect(function(){de&&he("/")},[de]),r.a.useEffect(function(){de&&F.getData().then(function(e){e&&Z(e)}).catch(function(e){console.log(e)})},[de]),r.a.useEffect(function(){de&&Object(m.a)(u.a.mark(function e(){var t;return u.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,F.getInitialCards();case 3:(t=e.sent)&&K(t),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),console.log(e.t0);case 10:case"end":return e.stop()}},e,null,[[0,7]])}))()},[de]),r.a.createElement("div",{className:"page"},r.a.createElement(g.Provider,{value:X},r.a.createElement("div",{className:"main"},r.a.createElement(_,{loggedIn:de,email:te.email,handleLogout:function(){localStorage.removeItem("jwt"),fe(!1),he.push("/signin")}}),r.a.createElement(d.d,null,r.a.createElement(d.b,{path:"/signup",element:r.a.createElement(x,{onSubmit:function(e,t){B.signup(e,t).then(function(e){ue(!!e)}).then(function(){console.log("you are now a special member")}).catch(function(e){console.log(e,"registration error")}).finally(function(){ce(!0)})}})}),r.a.createElement(d.b,{path:"/signin",element:r.a.createElement(j,{onSubmit:function(e,t){B.signin(e,t).then(function(n){if(n.token){localStorage.setItem("jwt",n.token);var a={email:e,password:t};window.location.reload(!0),fe(!0),ne(a)}}).catch(function(e){console.log(e)})}})}),r.a.createElement(d.b,{exact:!0,path:"/",loggedIn:de,element:r.a.createElement(L,{loggedIn:de,email:te.email},r.a.createElement(E,{loggedIn:de,onEditProfileClick:function(){a(!0)},onAddPlaceClick:function(){s(!0)},onEditAvatarClick:function(){k(!0)},onCardClick:function(e){Y(e),P(!0)},cards:W,onCardLike:function(e){e.likes.some(function(e){return e===X._id})?F.dislikeCard(e._id).then(function(e){_e(e)}).catch(function(e){console.log(e)}):F.likeCard(e._id).then(function(e){_e(e),console.log(X._id,"current user id")}).catch(function(e){console.log(e)})},onCardDelete:function(e){J(!0),Y(e)}}))}),r.a.createElement(d.b,{path:"*",element:r.a.createElement(d.a,{to:"signup"})})),r.a.createElement(N,{isOpen:n,onClose:ge,onUpdateUser:function(e){F.editUserInfo(e.name,e.about).then(function(e){Z(e),ge()}).catch(function(e){console.log(e)})}}),r.a.createElement(O,{isOpen:b,onClose:ge,onUpdateAvatar:function(e){try{F.editAvatar(e.avatar).then(function(e){Z(e),ge()})}catch(t){console.log(t,"frontend app.js"),console.log(e.avatar)}}}),r.a.createElement(S,{isOpen:i,onClose:ge,onAddPlaceSubmit:function(e,t){F.addPlaceCard(e,t).then(function(e){K([e].concat(Object(l.a)(W))),ge()}).catch(function(e){console.log(e)})}}),r.a.createElement(w,{isOpen:D,onClose:ge,onSubmit:function(e){e.preventDefault(),F.deleteCard(G._id).then(function(){K(function(e){return e.filter(function(e){return e._id!==G._id})}),ge()}).catch(function(e){console.log(e)})}}),r.a.createElement(y,{name:"preview-image",onClose:ge,isOpen:A,imageLink:G.link,imageText:G.name}),r.a.createElement(U,{name:"tooltip",isOpen:oe,onClose:ge,isRegistered:se}),r.a.createElement(v,null))))}var q=function(e){e&&e instanceof Function&&n.e(1).then(n.bind(null,87)).then(function(t){var n=t.getCLS,a=t.getFID,r=t.getFCP,o=t.getLCP,c=t.getTTFB;n(e),a(e),r(e),o(e),c(e)})};c.a.createRoot(document.getElementById("root")).render(r.a.createElement(r.a.StrictMode,null,r.a.createElement(i.a,null,r.a.createElement(J,null)))),q()}},[[15,3,2]]]);
//# sourceMappingURL=main.8100eeec.chunk.js.map