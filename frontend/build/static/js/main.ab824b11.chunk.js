(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{11:function(e,t,a){e.exports=a.p+"static/media/logo.8f7611ae.svg"},12:function(e,t,a){e.exports=a.p+"static/media/vSign.e38b395c.svg"},13:function(e,t,a){e.exports=a.p+"static/media/xSign.4072126c.svg"},15:function(e,t,a){e.exports=a(86)},24:function(e,t,a){},86:function(e,t,a){"use strict";a.r(t);var n=a(1),r=a.n(n),o=a(10),c=a.n(o),s=a(5),i=(a(24),a(14)),l=a(3),u=a.n(l),m=a(6),p=a(2),d=a(0),f=a(11),_=a.n(f);var h=function(e){e.props,e.isOpen;var t=e.loggedIn,a=e.handleLogout,n=e.email,o=(e.mobileMenu,e.showMobileIcon,Object(d.f)().pathname);return r.a.createElement("header",{className:"header"},r.a.createElement(s.b,{className:"logo",to:"/"},r.a.createElement("img",{id:"site-logo",src:_.a,alt:"Around the USA logo"})),t?r.a.createElement("div",{className:"header__menu",email:n},r.a.createElement("h2",{className:"header__user-email"},n),r.a.createElement(s.b,{className:"header__page-link",to:"/signin",onClick:a},"Log out")):r.a.createElement(r.a.Fragment,null,"/signin"===o?r.a.createElement(s.b,{to:"/signup",className:"header__page-link"},"Sign up"):r.a.createElement(s.b,{to:"/signin",className:"header__page-link"},"Log in")))},g=r.a.createContext();function b(e){var t=e.onCardClick,a=e.card,n=e.onCardLike,o=e.onCardDelete;var c=r.a.useContext(g),s=a.owner._id===c._id,i="elements__trash ".concat(s?"elements__trash":"elements__trash_disabled"),l=a.likes.some(function(e){return e._id===c._id}),u='"elements__heart" '.concat(l?"elements__heart elements__heart_active":"elements__heart");return r.a.createElement("li",{className:"elements__element"},r.a.createElement("button",{className:i,type:"button","aria-label":"delete card",onClick:function(){o(a)}}),r.a.createElement("img",{className:"elements__image",src:a.link,alt:a.name,onClick:function(){t(a)}}),r.a.createElement("div",{className:"elements__info"},r.a.createElement("h2",{className:"elements__text"},a.name),r.a.createElement("div",{className:"elements__like-container"},r.a.createElement("button",{className:u,type:"button","aria-label":"like card",onClick:function(){n(a)}}),r.a.createElement("div",{className:"elements__number-of-likes"},a.likes.length))))}function E(e){var t=e.onEditAvatarClick,a=e.onEditProfileClick,n=e.onAddPlaceClick,o=e.onCardClick,c=e.onCardLike,s=e.onCardDelete,i=e.cards,l=r.a.useContext(g);return r.a.createElement("main",null,r.a.createElement("section",{className:"profile"},r.a.createElement("div",{className:"profile__avatar-wrapper"},r.a.createElement("img",{className:"profile__avatar",src:l.avatar,alt:"My Avatar"}),r.a.createElement("button",{onClick:t,type:"button","aria-label":"edit-avatar-button",className:"profile__avatar-edit-button"})),r.a.createElement("div",{className:"profile__info"},r.a.createElement("div",null,r.a.createElement("h1",{className:"profile__name"},l.name),r.a.createElement("button",{onClick:a,"aria-label":"edit-button",type:"button",className:"profile__edit-button",name:"edit"})),r.a.createElement("h2",{className:"profile__title"},l.about)),r.a.createElement("button",{onClick:n,type:"button","aria-label":"add-button",className:"profile__add-button"})),r.a.createElement("section",{className:"elements"},r.a.createElement("ul",{className:"elements__list"},i.map(function(e){return r.a.createElement(b,{card:e,key:e._id,onCardClick:o,onCardLike:c,onCardDelete:s})}))))}var v=function(){return r.a.createElement("footer",{className:"footer"},r.a.createElement("p",{className:"footer__copyright"},"\xa9 ",(new Date).getFullYear()," Sara Weissman"))};function k(e){var t=e.name,a=e.isOpen,n=e.onClose,o=e.children;return r.a.useEffect(function(){if(a){var e=function(e){"Escape"===e.key&&n()};return document.addEventListener("keydown",e),function(){return document.removeEventListener("keydown",e)}}},[a,n]),r.a.createElement("div",{className:"modal ".concat(a?"modal_open":""," modal_type_").concat(t)},o)}function y(e){return r.a.createElement(k,{onClose:e.onClose,isOpen:e.isOpen,name:e.name},r.a.createElement("div",{className:"modal__image-wrapper"},r.a.createElement("button",{type:"button","aria-label":"close-button",className:"modal__close-button modal__close-button_type-preview",onClick:e.onClose}),r.a.createElement("figure",null,r.a.createElement("img",{src:e.imageLink,alt:e.imageText,className:"modal__image-container"}),r.a.createElement("figcaption",{className:"modal__image-caption"},e.imageText))))}function C(e){return r.a.createElement(k,{onClose:e.onClose,isOpen:e.isOpen,name:e.name},r.a.createElement("div",{className:"modal__container"},r.a.createElement("button",{type:"button","aria-label":"close-button",className:"modal__close-button",onClick:e.onClose}),r.a.createElement("h3",{className:"modal__title"},e.title),r.a.createElement("form",{action:"#",className:"form form-".concat(e.name),name:"form-".concat(e.name),onSubmit:e.onSubmit},e.children,r.a.createElement("button",{type:"submit",className:"form__button form__button_type-".concat(e.name),"aria-label":"delete-button"}," ",e.buttonText))))}function N(e){var t=r.a.useContext(g),a=r.a.useState(""),n=Object(p.a)(a,2),o=n[0],c=n[1],s=r.a.useState(""),i=Object(p.a)(s,2),l=i[0],u=i[1];return r.a.useEffect(function(){c(t.name||""),u(t.about||"")},[t,e.isOpen]),r.a.createElement(C,{name:"edit-profile",onClose:e.onClose,isOpen:e.isOpen,onSubmit:function(t){t.preventDefault(),e.onUpdateUser({name:o,about:l})},title:"Edit profile",buttonText:"Save"},r.a.createElement("input",{id:"input_type_name",type:"text",value:o,onChange:function(e){c(e.target.value)},className:"form__input form__input_type_name",placeholder:"name",name:"name",minLength:"2",maxLength:"40",required:!0}),r.a.createElement("span",{id:"input_type_name-error",className:"form__error"}),r.a.createElement("input",{id:"input_type_job",type:"text",value:l,onChange:function(e){u(e.target.value)},className:"form__input form__input_type_job",placeholder:"profession",name:"job",minLength:"2",maxLength:"200",required:!0}),r.a.createElement("span",{id:"input_type_job-error",className:"form__error"}))}function S(e){var t=r.a.useRef();return r.a.useEffect(function(){t.current.value=""},[]),r.a.createElement(C,{name:"edit-avatar",onClose:e.onClose,isOpen:e.isOpen,onSubmit:function(a){a.preventDefault(),e.onUpdateAvatar({avatar:t.current.value})},title:"Change profile picture",buttonText:"Save"},r.a.createElement("input",{ref:t,id:"input_type_avatar-url",type:"url",className:"form__input form__input_type_link",placeholder:"avatar link",name:"link",required:!0}),r.a.createElement("span",{id:"input_type_avatar-url-error",className:"form__error_visible"}))}function O(e){var t=r.a.useState(""),a=Object(p.a)(t,2),n=a[0],o=a[1],c=r.a.useState(""),s=Object(p.a)(c,2),i=s[0],l=s[1];return r.a.useEffect(function(){o(""),l("")},[e.isOpen]),r.a.createElement(C,{name:"add-place",onClose:e.onClose,isOpen:e.isOpen,onSubmit:function(t){t.preventDefault(),e.onAddPlaceSubmit({name:n,link:i})},title:"New place",buttonText:"Create"},r.a.createElement("input",{onChange:function(e){o(e.target.value)},value:n||"",id:"input_type_place",type:"text",className:"form__input form__input_type_place",placeholder:"Title",name:"place",minLength:"2",maxLength:"30",required:!0}),r.a.createElement("span",{id:"input_type_place-error",className:"form__error"}),r.a.createElement("input",{onChange:function(e){l(e.target.value)},value:i||"",id:"input_type_url",type:"url",className:"form__input form__input_type_link",placeholder:"Image link",name:"link",required:!0}),r.a.createElement("span",{id:"input_type_url-error",className:"form__error"}))}function x(e){return r.a.createElement(C,{name:"confirm-delete",title:"Are you Sure?",buttonText:"Yes",isOpen:e.isOpen,onSubmit:e.onSubmit})}function w(e){var t=r.a.useState(""),a=Object(p.a)(t,2),n=a[0],o=a[1],c=r.a.useState(""),i=Object(p.a)(c,2),l=i[0],u=i[1];return r.a.createElement("div",{className:"login"},r.a.createElement("p",{className:"login__title"},"Welcome back!"),r.a.createElement("form",{onSubmit:function(t){t.preventDefault(),n&&l?e.onSubmit(n,l):console.log("could not log in")},className:"login__form"},r.a.createElement("input",{className:"login__input",id:"email",name:"email",placeholder:"Email",type:"text",value:n,onChange:function(e){o(e.target.value)}}),r.a.createElement("input",{className:"login__input",id:"password",name:"password",type:"password",placeholder:"Password",value:l,onChange:function(e){u(e.target.value)}}),r.a.createElement("button",{type:"submit",className:"login__button"},"Log in")),r.a.createElement(s.b,{to:"/signup",className:"login__link"},"Not a member yet? Sign up here!"))}function j(e){var t=r.a.useState(""),a=Object(p.a)(t,2),n=a[0],o=a[1],c=r.a.useState(""),i=Object(p.a)(c,2),l=i[0],u=i[1];return r.a.createElement("div",{className:"login"},r.a.createElement("h1",{className:"login__title"},"Sign Up"),r.a.createElement("form",{className:"login__form",onSubmit:function(t){t.preventDefault(),n&&l?e.onSubmit(n,l):console.log("could not register")}},r.a.createElement("input",{className:"login__input",name:"email",placeholder:"Email",type:"email",value:n,onChange:function(e){o(e.target.value)}}),r.a.createElement("input",{className:"login__input",name:"password",placeholder:"Password",type:"password",value:l,onChange:function(e){u(e.target.value)}}),r.a.createElement("button",{className:"login__button",type:"submit"},"Sign Up")),r.a.createElement(s.b,{to:"/signin",className:"login__link"},"Already a member? Log in here!"))}var T=function(e){var t=e.loggedIn,a=e.redirectPath,n=void 0===a?"/signup":a,o=e.children;return t?o:r.a.createElement(d.a,{to:n,replace:!0})},L=a(12),A=a.n(L),P=a(13),R=a.n(P);function U(e){return r.a.createElement(k,{onClose:e.onClose,isOpen:e.isOpen,name:e.name},r.a.createElement("div",{className:"modal__container"},r.a.createElement("button",{type:"button","aria-label":"close-button",className:"modal__close-button",onClick:e.onClose}),e.isRegistered?r.a.createElement(r.a.Fragment,null,r.a.createElement("img",{src:A.a,alt:"success"}),r.a.createElement("h2",{className:"modal__title_type_tooltip"},"Success! You have now been registered.")):r.a.createElement(r.a.Fragment,null,r.a.createElement("img",{src:R.a,alt:"failure"}),r.a.createElement("h2",{className:"modal__title_type_tooltip"},"Oops, something went wrong! Please try again."))))}var I=a(7),D=a(8),B=new(function(){function e(t){Object(I.a)(this,e),this._BASE_URL=t.BASE_URL}return Object(D.a)(e,[{key:"checkResponse",value:function(e){return e.ok?e.json():Promise.reject("Error Type: \n    ".concat(e.status," ").concat(e.statusText))}},{key:"signup",value:function(e,t){return fetch("".concat(this._BASE_URL,"/signup"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:e,password:t})}).then(this.checkResponse)}},{key:"signin",value:function(e,t){return fetch("".concat(this._BASE_URL,"/signin"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:e,password:t})}).then(this.checkResponse).then(function(e){return localStorage.setItem("jwt",e.jwt),e})}},{key:"checkToken",value:function(e){return fetch("".concat(this._BASE_URL,"/users/me"),{method:"GET",headers:{Accept:"application/json","Content-Type":"application/json",Authorization:"Bearer ".concat(e)}}).then(this.checkResponse).then(function(e){return e})}}]),e}())({BASE_URL:"https://api.sarawsmn.students.nomoredomainssbs.ru"}),F=new(function(){function e(t){Object(I.a)(this,e),this.checkResponse=function(e){return e.ok?e.json():Promise.reject("Error Type: \n    ".concat(e.status," ").concat(e.statusText))},this._url=t.baseUrl,this._token=t.token,this._headers={authorization:this._token,"Content-type":"application/json"}}return Object(D.a)(e,[{key:"getData",value:function(){var e=Object(m.a)(u.a.mark(function e(){var t;return u.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("".concat(this._url,"/users/me"),{method:"GET",headers:this._headers});case 2:return t=e.sent,e.abrupt("return",this.checkResponse(t));case 4:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"getInitialCards",value:function(){var e=Object(m.a)(u.a.mark(function e(){var t;return u.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("".concat(this._url,"/cards"),{method:"GET",headers:this._headers});case 2:return t=e.sent,e.abrupt("return",this.checkResponse(t));case 4:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"editUserInfo",value:function(){var e=Object(m.a)(u.a.mark(function e(t,a){var n;return u.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("".concat(this._url,"/users/me/"),{method:"PATCH",headers:this._headers,body:JSON.stringify({name:t,about:a})});case 2:return n=e.sent,e.abrupt("return",this.checkResponse(n));case 4:case"end":return e.stop()}},e,this)}));return function(t,a){return e.apply(this,arguments)}}()},{key:"addPlaceCard",value:function(){var e=Object(m.a)(u.a.mark(function e(t,a){var n;return u.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("".concat(this._url,"/cards"),{method:"POST",headers:this._headers,body:JSON.stringify({name:t,link:a})});case 2:return n=e.sent,e.abrupt("return",this.checkResponse(n));case 4:case"end":return e.stop()}},e,this)}));return function(t,a){return e.apply(this,arguments)}}()},{key:"deleteCard",value:function(){var e=Object(m.a)(u.a.mark(function e(t){var a;return u.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("".concat(this._url,"/cards/").concat(t),{method:"DELETE",headers:this._headers});case 2:return a=e.sent,e.abrupt("return",this.checkResponse(a));case 4:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"likeCard",value:function(){var e=Object(m.a)(u.a.mark(function e(t){var a;return u.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("".concat(this._url,"/cards/likes/").concat(t),{method:"PUT",headers:this._headers});case 2:return a=e.sent,e.abrupt("return",this.checkResponse(a));case 4:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"dislikeCard",value:function(){var e=Object(m.a)(u.a.mark(function e(t){var a;return u.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("".concat(this._url,"/cards/likes/").concat(t),{method:"DELETE",headers:this._headers});case 2:return a=e.sent,e.abrupt("return",this.checkResponse(a));case 4:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"editAvatar",value:function(){var e=Object(m.a)(u.a.mark(function e(t){var a;return u.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("".concat(this._url,"/users/me/avatar"),{method:"PATCH",headers:this._headers,body:JSON.stringify({avatar:t})});case 2:return a=e.sent,e.abrupt("return",this.checkResponse(a));case 4:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()}]),e}())({baseUrl:"https://api.sarawsmn.students.nomoredomainssbs.ru"});function J(){var e=r.a.useState(!1),t=Object(p.a)(e,2),a=t[0],n=t[1],o=r.a.useState(!1),c=Object(p.a)(o,2),s=c[0],l=c[1],f=r.a.useState(!1),_=Object(p.a)(f,2),b=_[0],k=_[1],C=r.a.useState(!1),L=Object(p.a)(C,2),A=L[0],P=L[1],R=r.a.useState(!1),I=Object(p.a)(R,2),D=I[0],J=I[1],q=r.a.useState({}),M=Object(p.a)(q,2),G=M[0],Y=M[1],z=r.a.useState([]),H=Object(p.a)(z,2),W=H[0],K=H[1],Q=r.a.useState({}),V=Object(p.a)(Q,2),X=V[0],Z=V[1],$=r.a.useState({}),ee=Object(p.a)($,2),te=ee[0],ae=ee[1],ne=r.a.useState(!1),re=Object(p.a)(ne,2),oe=re[0],ce=re[1],se=r.a.useState(!1),ie=Object(p.a)(se,2),le=ie[0],ue=ie[1],me=r.a.useState(!1),pe=Object(p.a)(me,2),de=pe[0],fe=pe[1],_e=Object(d.g)();function he(e){K(function(t){return t.map(function(t){return t._id===e._id?e:t})})}function ge(){n(!1),l(!1),k(!1),P(!1),J(!1),ce(!1),Y({})}return r.a.useEffect(function(){var e=localStorage.getItem("jwt");e&&B.checkToken(e).then(function(e){if(e){var t={email:e.data.email,id:e.data._id};ae(t),fe(!0),_e.push("/")}}).catch(function(e){return console.error(e.status,e.statusText)})},[]),r.a.useEffect(function(){de&&_e("/")},[de]),r.a.useEffect(function(){F.getData().then(function(e){e&&Z(e)}).catch(function(e){console.log(e.status,e.statusText)})},[]),r.a.useEffect(function(){Object(m.a)(u.a.mark(function e(){var t;return u.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,F.getInitialCards();case 3:(t=e.sent)&&K(t),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),console.log(e.t0);case 10:case"end":return e.stop()}},e,null,[[0,7]])}))()},[]),r.a.createElement("div",{className:"page"},r.a.createElement(g.Provider,{value:X},r.a.createElement("div",{className:"main"},r.a.createElement(h,{loggedIn:de,email:te.email,handleLogout:function(){localStorage.removeItem("jwt"),fe(!1),_e.push("/signin")}}),r.a.createElement(d.d,null,r.a.createElement(d.b,{path:"/signup",element:r.a.createElement(j,{onSubmit:function(e,t){B.signup(e,t).then(function(e){ue(!!e)}).then(function(){fe(!0),_e("/")}).catch(function(e){console.log(e.status,e.statusText)}).finally(function(){ce(!0)})}})}),r.a.createElement(d.b,{path:"/signin",element:r.a.createElement(w,{onSubmit:function(e,t){B.signin(e,t).then(function(t){t.token&&(localStorage.setItem("jwt",t.token),ae({email:e}),fe(!0),_e("/"))}).catch(function(e){console.log(e.status,e.statusText)})}})}),r.a.createElement(d.b,{exact:!0,path:"/",loggedIn:de,element:r.a.createElement(T,{loggedIn:de,email:te.email},r.a.createElement(E,{loggedIn:de,onEditProfileClick:function(){n(!0)},onAddPlaceClick:function(){l(!0)},onEditAvatarClick:function(){k(!0)},onCardClick:function(e){Y(e),P(!0)},cards:W,onCardLike:function(e){e.likes.some(function(e){return e._id.toString()===X._id})?F.dislikeCard(e._id.toString()).then(function(e){he(e)}).catch(function(e){console.log(e.status,e.statusText)}):F.likeCard(e._id.toString()).then(function(e){he(e)}).catch(function(e){console.log(e.status,e.statusText)})},onCardDelete:function(e){J(!0),Y(e)}}))}),r.a.createElement(d.b,{path:"*",element:r.a.createElement(d.a,{to:"signup"})})),r.a.createElement(N,{isOpen:a,onClose:ge,onUpdateUser:function(e){F.editUserInfo(e.name,e.about).then(function(e){Z(e),ge()}).catch(function(e){console.log(e.status,e.statusText)})}}),r.a.createElement(S,{isOpen:b,onClose:ge,onUpdateAvatar:function(e){F.editAvatar(e.avatar).then(function(e){Z(e),ge()}).catch(function(e){console.log(e.status,e.statusText)})}}),r.a.createElement(O,{isOpen:s,onClose:ge,onAddPlaceSubmit:function(e){F.addPlaceCard(e.name,e.link).then(function(e){K([e].concat(Object(i.a)(W))),ge()}).catch(function(e){console.log(e.status,e.statusText)})}}),r.a.createElement(x,{isOpen:D,onClose:ge,onSubmit:function(e){e.preventDefault(),F.deleteCard(G._id).then(function(){K(function(e){return e.filter(function(e){return e._id!==G._id})}),ge()}).catch(function(e){console.log(e.status,e.statusText)})}}),r.a.createElement(y,{name:"preview-image",onClose:ge,isOpen:A,imageLink:G.link,imageText:G.name}),r.a.createElement(U,{name:"tooltip",isOpen:oe,onClose:ge,isRegistered:le}),r.a.createElement(v,null))))}var q=function(e){e&&e instanceof Function&&a.e(1).then(a.bind(null,87)).then(function(t){var a=t.getCLS,n=t.getFID,r=t.getFCP,o=t.getLCP,c=t.getTTFB;a(e),n(e),r(e),o(e),c(e)})};c.a.createRoot(document.getElementById("root")).render(r.a.createElement(r.a.StrictMode,null,r.a.createElement(s.a,null,r.a.createElement(J,null)))),q()}},[[15,3,2]]]);
//# sourceMappingURL=main.ab824b11.chunk.js.map